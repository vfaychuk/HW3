---
title: "HW3_379"
author: "Vladyslav Faychuk"
date: "2025-10-23"
output: pdf_document
---

```{r, include=TRUE, echo=TRUE}

read.csv("TextMessages.csv")

TMData <- read.csv("TextMessages.csv")

is.factor(TMData$Group)

is.factor(TMData$Participant)

TMData$Group <- as.factor(TMData$Group)

TMData$Participant <- as.factor(TMData$Participant)

#install.packages("ggplot2")

library(ggplot2)

boxplot_BaselinebyGroup <- ggplot(TMData, aes(Group, Baseline))

boxplot_BaselinebyGroup

boxplot_BaselinebyGroup + geom_boxplot()

boxplot_BaselinebyGroup + geom_boxplot() + labs(x="Group", y="Baseline")

min(TMData$Baseline)

max(TMData$Baseline)

boxplot_BaselinebyGroup + geom_boxplot() + labs(x="Group", y="Baseline") + 
  scale_y_continuous(limits = c(40, 100))

boxplot_BaselinebyGroup + geom_boxplot() + labs(x="Group", y="Baseline") + 
  scale_y_continuous(limits = c(40, 100), breaks = seq(from =40, to = 100, by = 5))

```


```{r, include=TRUE, echo=TRUE}
library(tidyverse)
textM <- read.csv("TextMessages.csv")
#Create stratified bar charts of text messages by Time
#Transform to long data to combine times (Baseline and six_months)
long_data <- textM %>% pivot_longer(cols = c(Baseline, Six_months),
               names_to = "Time",
               values_to = "Texts")

head(long_data)

# Create stratified bar chart
ggplot(long_data, aes(x = Time, y = Texts)) +
  stat_summary(fun = mean, geom = "bar", position = "dodge") +
  labs(
    title = "Average Number of Text Messages by Time",
    x = "Time",
    y = "Average Texts",
  ) 
```

```{r, include=TRUE, echo=TRUE}
#Using Vlads long_data
textM <- read.csv("TextMessages.csv")
long_data <- textM %>% pivot_longer(cols = c(Baseline, Six_months),
                                    names_to = "Time",
                                    values_to = "Texts")

#Creating summary Tables

# Summary table by Group
group_summary <- long_data |>
  group_by(Group) |>
  summarise(
    mean_texts = mean(Texts, na.rm = TRUE),
    median_texts = median(Texts, na.rm = TRUE),
    sd_texts = sd(Texts, na.rm = TRUE),
    min_texts = min(Texts, na.rm = TRUE),
    max_texts = max(Texts, na.rm = TRUE),
    n_participants = n_distinct(Participant),
    n_rows = n(),
    .groups = "drop"
  )

print(group_summary)
#summary table by Time
time_summary <- long_data |>
  group_by(Time) |>
  summarise(
    mean_texts = mean(Texts, na.rm = TRUE),
    sd_texts = sd(Texts, na.rm = TRUE),
    n = n(),
    se_texts = sd_texts / sqrt(n),
    .groups = "drop"
  )

print(time_summary)
# 3) By Group and Time
group_time_summary <- long_data |>
  group_by(Group, Time) |>
  summarise(
    mean_texts = mean(Texts, na.rm = TRUE),
    sd_texts = sd(Texts, na.rm = TRUE),
    n = n(),
    se_texts = sd_texts / sqrt(n),
    .groups = "drop"
  )

print(group_time_summary)
```
